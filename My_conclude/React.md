## React框架复习

**1. fetch发送2次请求的原因**
fetch发送post请求的时候，总是发送两次，第一次状态码是204，第二次才成功？
原因很简单，因为你用fetch的post请求的时候，导致fetch第一次发送了一个options请求 ，询问服务器是否支持修改请求头，如果服务器支持，则在第二次中发送正真的请求。

**2. 为什么虚拟dom会提高性能？**
* 虚拟dom相当于在js和真实dom中间加了一个缓存，利用dom diff算法的避免了没有必要的dom操作，从而提升性能。
* 具体实现步骤如下：
   1. 用 JavaScript 对象结构表示 DOM 树结构；然后用这个树构建一个真正DOM树，插入到文档当中，
   2. 当状态变更的时候，重新构造一棵新的对象数。然后用新的树和旧的树进行比较，记录两棵树差异
把2所记录的差异应用到步骤1所构建的真正的DOM树上，视图就更新了。

**<font color=red>3. 写React/Vue项目时为什么要在列表组件中写key，起作用时什么？**</font>

**4. React 中setState什么时候是同步的，什么时候是异步的? -** [面试题参考](https://blog.csdn.net/qq_43182723/article/details/106802413)
   1. setState只在合成事件和钩子函数中是“异步”的，在原生事件和setTimeout中都是同步的。
   2. setState的批量跟新优化也是建立在“异步”之上的，在原生事件和setTimeout中不会批量更新，**在“异步”中如果对同一个值进行多次setState，setState的批量更新策略会对其进行覆盖，取最后一次的执行**，如果是setState多个不同的值，在更新时会对其进行合并批量更新。
   3. setState 的“异步”并不是说内部由异步代码实现，其实本身执行的过程和代码都是同步的，只是合成事件和钩子函数的调用顺序在更新之前，导致在合成事件和钩子函数中没法立马拿到更新后的值，形成了所谓的“异步”，当然可以通过第二个参数 setState(partialState, callback) 中的callback拿到更新后的结果。

 